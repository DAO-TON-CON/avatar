(()=>{"use strict";var e={810:(e,a,n)=>{var t=n(294),s=n(935),r=n(212),i=n(886),o=n(509);const c="avatarConfigChanged",l="exportAvatar",d="resetView";var u=n(47),m=n(895);function h({candidates:e,predicate:a}){if(!e.length)return null;const n=e.shift();return a(n)?n:h({candidates:e=e.concat(n.children),predicate:a})}function p(e,a){return h({candidates:[e],predicate:e=>e.name===a})}function k({candidates:e,predicate:a,results:n=[]}){if(!e.length)return n;const t=e.shift();return a(t)&&n.push(t),k({candidates:e=e.concat(t.children),predicate:a,results:n})}function v(e,a){return k({candidates:[e],predicate:e=>e.type===a})}function _({object3D:e,depth:a=0,callback:n,result:t}){t.push(n(e,a));const s=e.children;for(let e=0;e<s.length;e++)_({object3D:s[e],depth:a+1,callback:n,result:t});return t}const f=function(){const e="  ";return function(a,n){const t=`${a.type} | ${a.name} | ${JSON.stringify(a.userData)}`;let s="";"SkinnedMesh"===a.type&&(s="\n".concat(e.repeat(n)).concat("First bone id: ").concat(a.skeleton.bones[0].uuid));let r="";return"Bone"===a.type&&(r="\n".concat(e.repeat(n)).concat("Bone id: ").concat(a.uuid)),e.repeat(n).concat(t).concat(s).concat(r)}}();function y(e){return _({object3D:e,callback:f,result:[]}).join("\n")}const N=function(){const e=new u.E;return function(a){return new Promise((function(n,t){e.load(a,(function(e){n(e)}),(function(e){}),(function(e){console.log("An error happened"),t(e)}))}))}}();function g(e){return e.gltfExtensions||(e.gltfExtensions={}),e.gltfExtensions.MOZ_hubs_components||(e.gltfExtensions.MOZ_hubs_components={}),e}const w=function(){const e=new o.M;return function(a,{binary:n,animations:t}){e.parse(a,(e=>{if(n){const a=new Blob([e],{type:"application/octet-stream"}),n=document.createElement("a");n.style.display="none",n.href=URL.createObjectURL(a),n.download="custom_avatar.glb",n.click(),n.remove()}else console.log(e)}),{binary:n,animations:t})}}();function E(e,a){const n=[];for(const t of a.animations)-1===e.animations.findIndex((e=>e.name===t.name))&&n.push(t);for(const a of n)e.animations.push(a)}const S={DOMContentLoaded:!1,shouldResize:!0,didInit:!1,scene:null,camera:null,renderer:null,controls:null,envMap:null,avatarNodes:{},avatarConfig:{},newAvatarConfig:{},shouldApplyNewAvatarConfig:!1,shouldExportAvatar:!1,shouldResetView:!1};async function b(e,a,n){const t=await N((s=a,s.startsWith("blob")?s:`assets/${s}.glb`));var s;S.avatarConfig[e]===a&&(t.scene.animations=t.animations,n.clear(),n.add(t.scene),t.scene.traverse((e=>{var a,n;n=e=>{e.isMeshStandardMaterial&&(e.envMap=S.envMap,e.needsUpdate=!0)},(a=e).material&&(Array.isArray(a.material)?a.material.forEach(n):n(a.material))})))}window.gameState=S,window.addEventListener("DOMContentLoaded",(()=>{S.DOMContentLoaded=!0})),window.onresize=()=>{S.shouldResize=!0},document.addEventListener(c,(e=>{S.newAvatarConfig=e.detail.avatarConfig,S.shouldApplyNewAvatarConfig=!0})),document.addEventListener(l,(()=>{S.shouldExportAvatar=!0})),document.addEventListener(d,(()=>{S.shouldResetView=!0})),window.requestAnimationFrame((function e(a){if(S.DOMContentLoaded&&!S.didInit&&(S.didInit=!0,function(){r.CtF.enabled=!0;const e=new r.xsS;e.fog=new r.yo9(9145226,.2),e.background=new r.Ilk(9145226),S.scene=e;const a=new r.cPb(75,window.innerWidth/window.innerHeight,.1,1e3);a.position.set(0,.25,1.5),S.camera=a;const n=new r.Mig(16777215,.4);e.add(n);const t=new r.CP7({canvas:document.getElementById("scene"),antialias:!0});S.renderer=t;const s=function(){const e=new m.q;e.scale.setScalar(45e4);const a=e.material.uniforms;a.turbidity.value=10,a.rayleigh.value=3,a.mieCoefficient.value=.005,a.mieDirectionalG.value=.7;const n=Math.PI*(.7-.5),t=2*Math.PI*(.55-.5),s=new r.Pa4;return s.x=Math.cos(t),s.y=Math.sin(t)*Math.sin(n),s.z=Math.sin(t)*Math.cos(n),a.sunPosition.value.copy(s),e}();S.envMap=function(e,a){const n=new r.xsS;n.add(e);const t=new r.anP(a),s=t.fromScene(n);return t.dispose(),n.remove(e),s.texture}(s,t);const o=new r.Kj0(new r.BKK(100,100),new r.Wid);o.position.y=-.2,o.rotation.x=-Math.PI/2,e.add(o);const c=new i.z(a,t.domElement);c.target=new r.Pa4(0,.5,0),c.update(),c.saveState(),S.controls=c,S.avatarGroup=new r.ZAu,e.add(S.avatarGroup)}()),S.didInit){if(S.shouldResize){S.shouldResize=!1;const e=S.renderer.domElement.parentNode.clientWidth,a=S.renderer.domElement.parentNode.clientHeight;S.renderer.setSize(e,a,!1),S.camera.aspect=e/a,S.camera.updateProjectionMatrix()}{const{renderer:e,scene:a,camera:n}=S;e.render(a,n)}if(S.shouldApplyNewAvatarConfig){S.shouldApplyNewAvatarConfig=!1;const e=new Set(Object.keys(S.newAvatarConfig).concat(Object.keys(S.avatarConfig)));for(const a of e)S.avatarNodes[a]||(S.avatarNodes[a]=new r.ZAu,S.avatarGroup.add(S.avatarNodes[a])),S.newAvatarConfig[a]!==S.avatarConfig[a]&&(null!==S.newAvatarConfig[a]?b(a,S.newAvatarConfig[a],S.avatarNodes[a]):S.avatarNodes[a].clear(),S.avatarConfig[a]=S.newAvatarConfig[a])}S.shouldExportAvatar&&(S.shouldExportAvatar=!1,function(e){const a=function(e){const a=new r.ZAu;a.name="Scene";const n=e.children.map((e=>p(e,"Scene"))).filter((e=>!!e));for(const e of n)E(a,e);const t=e.children.map((e=>p(e,"AvatarRoot"))).filter((e=>!!e)),s=t[0].clone(!1);for(const e of t)s.userData=(i=s.userData,o=e.userData,g(i),g(o),i.gltfExtensions.MOZ_hubs_components&&(i.gltfExtensions.MOZ_hubs_components=Object.assign(i.gltfExtensions.MOZ_hubs_components,o.gltfExtensions.MOZ_hubs_components)),i);var i,o;const c=v(e,"SkinnedMesh").map((e=>e.clone(!1))),l=function(e){const a=new Map;for(const n of e.skeleton.bones){const e=n.clone(!1);a.set(n,e)}return e.skeleton.bones[0].traverse((e=>{if("Bone"!==e.type)return;const n=a.get(e);for(const t of e.children)n.add(a.get(t))})),new r.OdW(e.skeleton.bones.map((e=>a.get(e))))}(c[0]);for(const e of c)e.bind(l);a.add(s),s.add(l.bones[0]);for(const e of c)s.add(e);return a}(e);console.log(y(a)),console.log(a),w(a,{binary:!1,animations:a.animations}),w(a,{binary:!0,animations:a.animations})}(S.avatarGroup)),S.shouldResetView&&(S.shouldResetView=!1,S.controls.reset()),window.requestAnimationFrame(e)}else requestAnimationFrame(e)}));const x={Earring:[{value:null,displayName:"none",excludeFromRandomize:!1},{value:"accessory_earring_leftHigh01-silver",displayName:"LeftHigh01-silver"}],Sunglasses:[{value:null,displayName:"none",excludeFromRandomize:!1},{value:"accessory_sunglasses_arnette",displayName:"Arnette"},{value:"accessory_sunglasses_punk02",displayName:"Punk02"}],Eyebrows:[{value:null,displayName:"none",excludeFromRandomize:!0},{value:"character_eyebrows_brown",displayName:"Brown"}],Eyes:[{value:null,displayName:"none",excludeFromRandomize:!0},{value:"character_eyes_male01-blue",displayName:"Male01-blue"},{value:"character_eyes_male01-brown",displayName:"Male01-brown"}],Hands:[{value:null,displayName:"none",excludeFromRandomize:!0},{value:"character_hands_skin1",displayName:"Skin1"},{value:"character_hands_skin2",displayName:"Skin2"},{value:"character_hands_skin3",displayName:"Skin3"},{value:"character_hands_skin4",displayName:"Skin4"},{value:"character_hands_skin5",displayName:"Skin5"},{value:"character_hands_skin6",displayName:"Skin6"},{value:"character_hands_skin7",displayName:"Skin7"},{value:"character_hands_skin8",displayName:"Skin8"},{value:"character_hands_skinA",displayName:"SkinA"},{value:"character_hands_skinB",displayName:"SkinB"},{value:"character_hands_skinC",displayName:"SkinC"},{value:"character_hands_skinD",displayName:"SkinD"},{value:"character_hands_skinE",displayName:"SkinE"},{value:"character_hands_skinF",displayName:"SkinF"},{value:"character_hands_skinG",displayName:"SkinG"},{value:"character_hands_skinH",displayName:"SkinH"}],HeadNeckEars:[{value:null,displayName:"none",excludeFromRandomize:!0},{value:"character_headNeckEars_skin1",displayName:"Skin1"},{value:"character_headNeckEars_skin2",displayName:"Skin2"},{value:"character_headNeckEars_skin3",displayName:"Skin3"},{value:"character_headNeckEars_skin4",displayName:"Skin4"},{value:"character_headNeckEars_skin5",displayName:"Skin5"},{value:"character_headNeckEars_skin6",displayName:"Skin6"},{value:"character_headNeckEars_skin7",displayName:"Skin7"},{value:"character_headNeckEars_skin8",displayName:"Skin8"},{value:"character_headNeckEars_skinA",displayName:"SkinA"},{value:"character_headNeckEars_skinB",displayName:"SkinB"},{value:"character_headNeckEars_skinC",displayName:"SkinC"},{value:"character_headNeckEars_skinD",displayName:"SkinD"},{value:"character_headNeckEars_skinE",displayName:"SkinE"},{value:"character_headNeckEars_skinF",displayName:"SkinF"},{value:"character_headNeckEars_skinG",displayName:"SkinG"},{value:"character_headNeckEars_skinH",displayName:"SkinH"}],Mouth:[{value:null,displayName:"none",excludeFromRandomize:!0},{value:"character_mouth_smirk_skin1",displayName:"Smirk skin1"},{value:"character_mouth_smirk_skin2",displayName:"Smirk skin2"},{value:"character_mouth_smirk_skin3",displayName:"Smirk skin3"},{value:"character_mouth_smirk_skin4",displayName:"Smirk skin4"},{value:"character_mouth_smirk_skin5",displayName:"Smirk skin5"},{value:"character_mouth_smirk_skin6",displayName:"Smirk skin6"},{value:"character_mouth_smirk_skin7",displayName:"Smirk skin7"},{value:"character_mouth_smirk_skin8",displayName:"Smirk skin8"},{value:"character_mouth_smirk_skinA",displayName:"Smirk skinA"},{value:"character_mouth_smirk_skinB",displayName:"Smirk skinB"},{value:"character_mouth_smirk_skinC",displayName:"Smirk skinC"},{value:"character_mouth_smirk_skinD",displayName:"Smirk skinD"},{value:"character_mouth_smirk_skinE",displayName:"Smirk skinE"},{value:"character_mouth_smirk_skinF",displayName:"Smirk skinF"},{value:"character_mouth_smirk_skinG",displayName:"Smirk skinG"},{value:"character_mouth_smirk_skinH",displayName:"Smirk skinH"}],FacialHair:[{value:null,displayName:"none",excludeFromRandomize:!1},{value:"facialHair_goatee05",displayName:"Goatee05"}],Hair:[{value:null,displayName:"none",excludeFromRandomize:!1},{value:"hair_fauxhawk1",displayName:"Fauxhawk1"},{value:"hair_male_spikey01",displayName:"Male spikey01"}],Torso:[{value:null,displayName:"none",excludeFromRandomize:!0},{value:"torso_shirt_male_sportCoat01",displayName:"Shirt male sportCoat01"},{value:"torso_shirt_male_tshirt-moz",displayName:"Shirt male tshirt-moz"},{value:"torso_shirt_male_tshirt-unionJack",displayName:"Shirt male tshirt-unionJack"}]};function C({onPartSelected:e,parts:a,selected:n}){return t.createElement("select",{onChange:a=>{e(a.target.selectedOptions[0].getAttribute("value"))},value:n||""},a.map(((e,a)=>t.createElement("option",{key:a,value:e.value},e.displayName))))}function A(){const[e,a]=(0,t.useState)(x),n=Object.keys(e);function s(){const a={};for(const t of n){const n=e[t].filter((e=>!e.excludeFromRandomize));if(0===n.length)continue;const s=Math.floor(Math.random()*n.length);a[t]=n[s].value}return a}const r=s(),[i,o]=(0,t.useState)(r);function u(e){o({...i,...e})}return(0,t.useEffect)((()=>{document.dispatchEvent(new CustomEvent(c,{detail:{avatarConfig:i}}))})),t.createElement(t.Fragment,null,n.map((a=>t.createElement("div",{key:a,className:"category"},t.createElement("span",null,a,": "),t.createElement(C,{selected:i[a],onPartSelected:e=>{u({[a]:e})},parts:e[a]})))),t.createElement("button",{onClick:function(){o(s())}},"Randomize avatar"),t.createElement("button",{onClick:function(){document.dispatchEvent(new CustomEvent(l))}},"Export avatar"),t.createElement("button",{onClick:function(){document.dispatchEvent(new CustomEvent(d))}},"Reset camera view"),t.createElement("label",null,"Upload custom part:",t.createElement("input",{onChange:function(n){const t=n.target.files[0],s=t.name,r=s.substring(0,s.indexOf("_"))||"custom",i=s.substring(s.indexOf("_")+1,s.lastIndexOf(".")),o=URL.createObjectURL(t),c={...e};c[r]=c[r]||[{displayName:"none",value:null}],c[r].push({displayName:i,value:o}),a(c),u({[r]:o})},type:"file",id:"input",accept:"model/gltf-binary,.glb"})))}s.render(t.createElement(A,null),document.getElementById("root"))}},a={};function n(t){if(a[t])return a[t].exports;var s=a[t]={exports:{}};return e[t](s,s.exports,n),s.exports}n.m=e,n.x=e=>{},n.d=(e,a)=>{for(var t in a)n.o(a,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},n.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),(()=>{var e={179:0},a=[[810,536]],t=e=>{},s=(s,r)=>{for(var i,o,[c,l,d,u]=r,m=0,h=[];m<c.length;m++)o=c[m],n.o(e,o)&&e[o]&&h.push(e[o][0]),e[o]=0;for(i in l)n.o(l,i)&&(n.m[i]=l[i]);for(d&&d(n),s&&s(r);h.length;)h.shift()();return u&&a.push.apply(a,u),t()},r=self.webpackChunk=self.webpackChunk||[];function i(){for(var t,s=0;s<a.length;s++){for(var r=a[s],i=!0,o=1;o<r.length;o++){var c=r[o];0!==e[c]&&(i=!1)}i&&(a.splice(s--,1),t=n(n.s=r[0]))}return 0===a.length&&(n.x(),n.x=e=>{}),t}r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r));var o=n.x;n.x=()=>(n.x=o||(e=>{}),(t=i)())})(),n.x()})();
//# sourceMappingURL=main-3f2030a97903c44da066.js.map